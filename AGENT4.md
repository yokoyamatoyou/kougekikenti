### **プロジェクト名：オールインワン誹謗中傷証拠収集ツール (v10.0 \- 最終完成版)**

### **1\. 開発目標**

X(旧Twitter)の仕様変更に対応した新ライブラリ(ntscraper)を採用し、未知の攻撃者を発見する「発見モード」と、特定のユーザーを深掘りする「分析モード」を備える。さらに、ユーザーがGUI上で攻撃性スコアのしきい値を自由に設定でき、それに基づき選択した投稿のウェブ魚拓を一括作成する、高度にパーソナライズされたプロフェッショナルな証拠収集プラットフォームを構築する。

### **2\. 提案するディレクトリ構造**

aggression\_analyzer/  
├── main.py                 \# アプリケーションのメインエントリーポイント  
├── requirements.txt        \# 依存ライブラリリスト  
├── .env.example            \# 環境変数設定のテンプレート  
├── .gitignore              \# Git管理対象外ファイル  
├── README.md               \# 開発者向け説明書 (英語)  
│  
├── docs/  
│   └── manual\_ja.md        \# ★ユーザー向け日本語説明書  
│  
├── config/  
│   └── settings.py         \# 設定ファイル  
│  
├── gui/  
│   └── app.py              \# GUIアプリケーション本体  
│  
├── modules/  
│   ├── scraper.py          \# データ収集モジュール  
│   └── analyzer.py         \# AI分析モジュール  
│  
├── tests/  
│   ├── \_\_init\_\_.py  
│   └── test\_scraper.py     \# ★データ収集モジュールの単体テスト  
│  
└── output/                 \# 分析結果のExcelファイルを保存するディレクトリ  
    └── .gitkeep

### **3\. AIエージェント向け 高詳細開発指示**

### **【フェーズ0】 プロジェクトのセットアップとリファクタリング**

（v9.0計画書と同様）

### **【フェーズ1】 データ収集モジュールの機能拡張と検証**

**目的:** 新ライブラリntscraperを使用し、安定したデータ収集機能を実現し、その動作を保証する。

* **タスク 1.1: 【変更】Scraperクラスの機能拡張 (modules/scraper.py)**  
  * （v9.0計画書と同様）snscrapeをntscraperに置き換えて、scrape\_user\_postsとsearch\_posts\_by\_keywordを実装する。  
* **タスク 1.2: 【NEW】データ収集モジュールの単体テスト (tests/test\_scraper.py)**  
  * **目的:** scraper.pyが期待通りに動作することを、自動テストによって検証する。  
  * **実装要件:**  
    1. unittestまたはpytestフレームワークを使用する。  
    2. 以下のテストケースを実装する。  
       * **正常系テスト:**  
         * 実在する公開ユーザーIDを指定し、投稿がDataFrameとして取得できるか。  
         * 一般的なキーワードで検索し、投稿がDataFrameとして取得できるか。  
       * **異常系テスト:**  
         * 存在しないユーザーIDを指定した場合に、エラーを起こさず空のDataFrameを返すか。  
         * 誰も使わないようなキーワードで検索し、結果が0件になるか。  
       * **データ形式テスト:**  
         * 返されるDataFrameが、指定された列（timestamp, url, content, user\_nameなど）を全て含んでいるか。  
* **【検証ステップ 1】**  
  * python \-m unittest tests/test\_scraper.py などを実行し、全てのテストが成功することを確認する。

### **【フェーズ2〜4】**

（v9.0計画書と同様）高速並列分析エンジンの実装、GUIの刷新、ユーザー主導型の高度な証拠保全機能を実装する。

### **【NEW】【フェーズ5】 総合内部テスト**

**目的:** 全ての機能を組み合わせた状態で、アプリケーション全体がユーザーの期待通りに動作することを、実際の使用ケースを想定して網羅的にテストする。

* **タスク 5.1: テストシナリオの実行**  
  * 以下のシナリオに基づき、手動でアプリケーションを操作し、結果を確認する。  
  * **シナリオA：発見モードのテスト**  
    1. アプリを起動。  
    2. 「キーワード発見モード」タブを選択。  
    3. 最近話題のキーワードと期間を入力し、「検索＆一次分析」を実行。  
    4. プログレスバーが進み、処理中にUIが固まらないことを確認。  
    5. 結果表示エリアに「要注意ユーザー」がリストアップされることを確認。  
    6. 「全投稿データをダウンロード」ボタンを押し、分析結果付きのExcelがoutputフォルダに保存されることを確認。  
    7. リストアップされたユーザーの一人をクリックし、そのIDが「個別ユーザー分析モード」に自動で入力されることを確認。  
  * **シナリオB：分析モードのテスト**  
    1. 「個別ユーザー分析モード」タブを選択。  
    2. テスト用の悪質なユーザーIDを入力し、「収集＆分析開始」を実行。  
    3. 結果リストがスコアに応じて色分け表示されることを確認。  
    4. スコアしきい値のスライダーを動かし、チェックマークがリアルタイムに更新されることを確認。  
    5. 手動でチェックを数件追加・削除する。  
    6. 「選択した投稿の魚拓をまとめて作成」ボタンを押し、バックグラウンドで処理が実行され、Excelに魚拓URLが追記されることを確認。  
    7. 分析結果のExcelに「UserProfile」シートが作成されていることを確認。  
  * **シナリオC：エッジケースのテスト**  
    1. 存在しないユーザーIDで分析を実行し、エラーメッセージが適切に表示されることを確認。  
    2. 投稿が0件のユーザーIDで分析を実行し、エラーなく処理が完了することを確認。  
* **【検証ステップ 5】**  
  * 上記全てのテストシナリオで、エラーが発生せず、期待通りの結果が得られることを確認する。

### **【フェーズ6】 最終化とドキュメント整備**

* **タスク 6.1: コードのクリーンアップと型ヒントの追加**  
  * （v9.0計画書と同様）  
* **タスク 6.2: 開発者向けドキュメントの作成 (README.md)**  
  * （v9.0計画書と同様）英語で、プロジェクトの目的、アーキテクチャ、セットアップ方法、テストの実行方法などを記述する。  
* **タスク 6.3: 【NEW】ユーザー向け日本語説明書の作成 (docs/manual\_ja.md)**  
  * **目的:** ITに詳しくないユーザーでも、ツールのインストールから基本的な操作までを一人で行えるように、分かりやすい日本語の説明書を作成する。  
  * **記載必須項目:**  
    1. **はじめに:** このツールが何をするためのものか。  
    2. **準備するもの:**  
       * OpenAI APIキーの取得方法（公式サイトへのリンクと簡単な説明）。  
       * 取得したAPIキーを.envファイルに設定する方法。  
    3. **インストールと起動:**  
       * Pythonのインストール（推奨）。  
       * コマンドプロンプト（ターミナル）でのpip install \-r requirements.txtの実行方法。  
       * python main.pyでの起動方法。  
    4. **画面の基本的な使い方:**  
       * 「キーワード発見モード」の使い方（各入力欄とボタンの説明）。  
       * 「個別ユーザー分析モード」の使い方（各入力欄とボタン、スライダーの説明）。  
       * 「魚拓の一括作成」の操作手順。  
    5. **出力されるExcelファイルについて:**  
       * 各シート（分析結果、ユーザー情報）と各列の意味を説明。  
    6. **注意事項・免責事項:**  
       * ツールの利用は自己責任であること。  
       * Xや各サービスの利用規約を遵守すること。  
       * 短時間での過度な使用は避けること。  
* **【検証ステップ 6】**  
  * README.mdとdocs/manual\_ja.mdの指示のみで、クリーンな環境のPCで、ツールのセットアップから全機能の利用までが問題なく行えることを最終確認する。

### **AIエージェント進捗ログ**

*AIエージェントは、各タスク完了後にこのリストを更新すること。*

* [x] **Phase 0**  
* [x] **Phase 1**  
* [x] **Phase 2**  
* [x] **Phase 3**  
* [x] **Phase 4**  
* [x] **Phase 5**  
* [x] **Phase 6**
* [x] 2025-07-11 現行の実装がAGENT4.mdと一致することを確認
